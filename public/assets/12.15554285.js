var B=Object.defineProperty;var P=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var f=(t,s,i)=>s in t?B(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,S=(t,s)=>{for(var i in s||(s={}))q.call(s,i)&&f(t,i,s[i]);if(P)for(var i of P(s))z.call(s,i)&&f(t,i,s[i]);return t};var r=(t,s,i)=>(f(t,typeof s!="symbol"?s+"":s,i),i);import"./modulepreload-polyfill.b7f2da20.js";import{g as G,b as Y,f as Q}from"./painterState.2081fc22.js";import{l as J,w as K,a as O,b as W}from"./lines_3d.f5b3b669.js";import{a as X,g as Z}from"./ast.22bf2736.js";import{j as E,u as v,k as p,o as H,l as b,n as l,x as a,w as x,B as M,Q as ee,y as te,R as se,N as m,z as d,$ as ie,M as T,D as A,O as ae,S as L,v as h,L as ne}from"./vendor.86045b5f.js";import{g as oe}from"./texture-helpers.e15866c2.js";import{i as re}from"./perspectiveViewport.0dcf679b.js";import{a as le,s as ce}from"./frameLoop.428c2956.js";import"./pointer.1f73fbf8.js";import"./vectors.212c15dd.js";import"./primitives.6d8411f1.js";import"./core.b58d4e59.js";import"./core.f107e89c.js";import"./noise.095b1379.js";import"./camera.94126e27.js";const pe=document.getElementById("canvas"),e=G(pe),g=S({},Y),me=3,F=4.3;let u=!1;function y(){return u=!u,{currentTime:0,duration:F*300,turn:u?0:Math.random()>=.5?Math.PI:-Math.PI}}const R=W({direction:[0,1,0],normal:[0,0,1],vertex:[0,-3,0]}),I=1.6;class de{constructor(){r(this,"step",y());r(this,"segment",R);r(this,"lineStartPoints");r(this,"lineEndPoints",J(I,R))}update(s){const i=s/this.step.duration;this.step.currentTime+=s;const j=K({length:me*s/1e3,normalAngle:i*this.step.turn},this.segment);this.lineStartPoints=this.lineEndPoints,this.lineEndPoints=O(I,this.segment,j),this.segment=j,this.step.currentTime>=this.step.duration&&(this.step=y())}}e.set("squeegee",new de);e.listen("Squeegee",g.FRAME,t=>{t.squeegee.update(t.device.tpf)});const N=X(),C=Z();let n,D,V,k,U;const ge=C(E([U=v("mat4","view"),k=v("mat4","projection"),D=p("vec3","position"),V=p("vec2","uv"),n=H("vec2","vUv"),b(()=>[l(n,V),l(C.gl_Position,a(k,a(U,x(D,1))))])]));let _,c,o;const ue=N(E([_=v("sampler2D","noiseTex"),p("vec3","vNormal"),n=p("vec2","vUv"),b(()=>[c=M(ee(_,a(n,te(1,10)))),o=M(se(m(m(m(d(T(c)),d(A(c))),d(ae(c))),d(ie(c))))),l(o,L(o,h(.15))),l(o,a(a(o,a(ne(m(h(1),o),L(A(n),h(4))),.5)),1)),l(N.gl_FragColor,x(1,0,0,T(n)))])]));re(e,{position:[0,0,15]});const fe=e.getShade("line").update({vert:ge,frag:ue}),$=e.getForm("line"),ve=e.getLayer("noiseTex").update({texture:oe({width:256,height:256,startX:3,startY:3,data:{magFilter:"LINEAR",minFilter:"LINEAR",wrap:"REPEAT"}})}),he=e.getSketch("line").update({form:$,shade:fe,uniforms:{noiseTex:ve.image()}}),w=e.getLayer("scene").update({sketches:[he],uniforms:{view:()=>e.state.viewPort.camera.viewMat,projection:()=>e.state.viewPort.camera.projectionMat},drawSettings:{clearColor:[1,1,1,1],enable:[e.gl.BLEND,e.gl.CULL_FACE],cullFace:e.gl.BACK}});e.listen("renderer",g.FRAME,({squeegee:t})=>{$.update({attribs:{position:{buffer:new Float32Array(Q(t.lineStartPoints.concat(t.lineEndPoints))),storeType:"DYNAMIC"},uv:{buffer:new Float32Array([0,0,1,0,0,1,1,1]),storeType:"DYNAMIC"}},drawType:"TRIANGLE_STRIP",itemCount:4})});e.state.device.sizeMultiplier=window.devicePixelRatio;le(t=>{e.state.device.tpf=Math.min(t,60),e.emit(g.FRAME),e.painter.compose(w).show(w)},"loop");e.listen("index",g.RESIZE,()=>{w.update()});ce();(!1).accept();
