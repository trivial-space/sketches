var E=Object.defineProperty;var T=(e,t,s)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var v=(e,t,s)=>(T(e,typeof t!="symbol"?t+"":t,s),s);import"./modulepreload-polyfill.b7f2da20.js";import{c as g}from"./core.f107e89c.js";import{g as z,t as C,f as A,h as D,i as F,r as O,s as P}from"./painterState.2081fc22.js";import{c as U}from"./lines.d75a440f.js";import{c as q}from"./points.c0fbbf77.js";import{s as M,n as S,l as b,d as G,a as w,m as B}from"./vectors.212c15dd.js";import"./pointer.1f73fbf8.js";import"./ast.22bf2736.js";import"./vendor.86045b5f.js";import"./quad.93433895.js";import"./primitives.6d8411f1.js";import"./core.b58d4e59.js";const K=(e,t,s)=>({h:e,s:t,l:s});function N({h:e,s:t,l:s}){const o=(1-Math.abs(2*s-1))*t,n=o*(1-Math.abs(e*6%2-1)),c=s-o/2;let a,r,p;return e<1/6?(a=o,r=n,p=0):e<2/6?(a=n,r=o,p=0):e<.5?(a=0,r=o,p=n):e<4/6?(a=0,r=n,p=o):e<5/6?(a=n,r=0,p=o):(a=o,r=0,p=n),a=g(0,1,a+c),r=g(0,1,r+c),p=g(0,1,p+c),[a,r,p]}const j=document.getElementById("canvas"),l=z(j);class f{constructor(t){v(this,"value");this.value=t}static of(t){return new f(t)}of(t){return new f(t)}map(t){return new f(t(this.value))}ap(t){return t.flatMap(this.map.bind(this))}flatMap(t){return t(this.value)}combine(t,s){return this.flatMap(o=>s.flatMap(n=>f.of(t(o,n))))}pull(t,s){return this.flatMap(o=>f.of(t(o,s)))}}function I(e,t,s){return e[t]=s(e[t]),e}const d=40,L=6,Q=200,i=C(e=>({id:e,pos:[Math.random()*j.width,Math.random()*j.height],ns:D(L),force:[0,0]}),d),k=A(C(e=>{if(e<d-3){const t=F(e+1,d-1),s=[[e,t]],o=F(e+1,d-1);return o!==t&&s.push([e,o]),s}else return[]},d));function u(e,t,s,o){const n=c=>a=>c.combine(B,t).pull(w,a).value;I(s,"force",n(e)),I(o,"force",n(e.map(c=>-c)))}function W(e){for(const t of k){const s=i[t[0]],o=i[t[1]],n=f.of(o.pos).pull(M,s.pos),c=n.map(S),a=n.map(b).map(r=>r-Q).map(r=>r*2);u(a,c,s,o)}for(let t=0;t<i.length-1;t++){const s=i[t];for(let o=t+1;o<i.length;o++){const n=i[o],c=f.of(n.pos).pull(M,s.pos),a=c.map(S),r=c.map(b),p=r.map(m=>-Math.max(100-m,0));if(u(p,a,s,n),n.ns===s.ns){const m=r.map(h=>h-100);u(m,a,s,n)}else{const m=r.map(h=>-Math.max(200-h,0));u(m,a,s,n)}}}for(const t of i){const s=t.force,o=b(s)-3;if(o>0){const n=G(o+3,s);t.pos=w(t.pos,B(o*(e/500),n)),t.force=[0,0]}}return i}const x=q(l,"points",{pointSize:20,dynamicForm:!0}),y=U(l,"lines",{lineWidth:3,color:[1,1,1,1],dynamicForm:!0,drawSettings:{clearColor:[0,0,0,1],clearBits:l.gl.COLOR_BUFFER_BIT,cullFace:l.gl.BACK,enable:[l.gl.CULL_FACE]}}),H=10;let R=0;O(e=>{R+=e,W(e),x.update({positions:i.map(t=>t.pos),colors:i.map(t=>[...N(K(t.ns/L,1,.5)),1])}),y.update({segments:k.map(([t,s])=>[i[t].pos,i[s].pos])}),l.painter.draw({sketches:[y.sketch,x.sketch]}),R>=H*1e3&&P("render")},"render");(!1).accept();
